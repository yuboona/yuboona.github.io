<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Don&apos;t focus too much.">
<meta property="og:type" content="website">
<meta property="og:title" content="Focus on my own.">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Focus on my own.">
<meta property="og:description" content="Don&apos;t focus too much.">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Focus on my own.">
<meta name="twitter:description" content="Don&apos;t focus too much.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Focus on my own.</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Focus on my own.</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Before changing the wold, I will figure out who I am.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/如何在深度学习中使用开源Chinese-Word-Vectors/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/如何在深度学习中使用开源Chinese-Word-Vectors/" itemprop="url">如何在深度学习中使用开源Chinese Word Vectors</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T21:06:18+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NLP/" itemprop="url" rel="index">
                    <span itemprop="name">NLP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="如何在深度学习中使用开源Chinese-Word-Vectors"><a href="#如何在深度学习中使用开源Chinese-Word-Vectors" class="headerlink" title="如何在深度学习中使用开源Chinese Word Vectors"></a>如何在深度学习中使用开源Chinese Word Vectors</h1><blockquote>
<p>摘要:Chinese-Word-Vectors开源项目提供了100多种预训练模型，但在深度学习中使用时，加载预训练向量存在词表重复项问题。本文着重于解决加载问题。</p>
</blockquote>
<h2 id="1-起因"><a href="#1-起因" class="headerlink" title="1. 起因"></a>1. 起因</h2><p>去年半年一直在搭建我的NLP练习项目——<a href="https://github.com/yuboona/punctuation-restoration-pytorch" target="_blank" rel="noopener">为语音识别文本进行标点恢复</a>，使用的技术如下所示：</p>
<ul>
<li>词向量训练</li>
<li>BiLSTM</li>
<li>CRF</li>
</ul>
<p>但是上面的技术在训练网络的时候，词向量是在训练中不断训练得到的。一方面这样的词向量更配合网络的结构，具有任务特定性；但是另一方面，受限于语料大小和计算资源，直接由自己的数据集训练出的词向量肯定是<strong>不够泛化，不够强健的</strong>。</p>
<h2 id="2-Chinese-Word-Vectors技术方案存在的问题"><a href="#2-Chinese-Word-Vectors技术方案存在的问题" class="headerlink" title="2. Chinese-Word-Vectors技术方案存在的问题"></a>2. Chinese-Word-Vectors技术方案存在的问题</h2><p>时至今日，在2019年bert横扫NLP任务之后，使用<strong>预训练模型</strong>已经不再稀奇。使用预训练的模型可以用更少的训练资源得到较好的效果。即使是使用传统的word2vec也能有效提高模型的泛化性。</p>
<p><a href="https://github.com/Embedding/Chinese-Word-Vectors" target="_blank" rel="noopener">Chinese-Word-Vectors</a>是北京师范大学和人民大学的研究者开源出来的100多个中文预训练词向量，所有向量都是在word2vec和skip-gram上训练出来的。</p>
<p>久仰大名，码下很久，但是未尝亲自试用。亲自使用后，便发现了一些问题。</p>
<ul>
<li>如何读取从<a href="https://github.com/Embedding/Chinese-Word-Vectors" target="_blank" rel="noopener">Chinese-Word-Vectors</a>下载下来的词向量？</li>
<li>读取时发现词表有重复，导致存入python字典中后，导致词表大小和训练好的词向量矩阵不一致？</li>
<li>读取到的词向量矩阵如何载入到深度学习模型的词嵌入矩阵embedding中？</li>
</ul>
<p>果然<strong>纸上得来终觉浅，绝知此事要躬行</strong>。</p>
<h2 id="3-问题解决方式"><a href="#3-问题解决方式" class="headerlink" title="3. 问题解决方式"></a>3. 问题解决方式</h2><ol>
<li>词向量文件本身是以文本方式存储的，第一行是词向量size信息，后面每一行是每个词和它的词向量。通过使用<a href="https://github.com/zhezhaoa/ngram2vec" target="_blank" rel="noopener">ngram2vec工具</a>中的代码可以加载词向量（Chinese-Word-Vectors也使用了ngram2vec工具来训练）:</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_dense</span><span class="params">(path)</span>:</span></span><br><span class="line">    vocab_size, size = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    vocab = &#123;&#125;</span><br><span class="line">    vocab[<span class="string">"i2w"</span>], vocab[<span class="string">"w2i"</span>] = [], &#123;&#125;</span><br><span class="line">    <span class="keyword">with</span> codecs.open(path, <span class="string">"r"</span>, <span class="string">"utf-8"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        first_line = <span class="keyword">True</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            <span class="keyword">if</span> first_line:</span><br><span class="line">                first_line = <span class="keyword">False</span></span><br><span class="line">                vocab_size = int(line.strip().split()[<span class="number">0</span>])</span><br><span class="line">                size = int(line.rstrip().split()[<span class="number">1</span>])</span><br><span class="line">                matrix = np.zeros(shape=(vocab_size, size), dtype=np.float32)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            vec = line.strip().split()</span><br><span class="line">            vocab[<span class="string">"i2w"</span>].append(vec[<span class="number">0</span>])</span><br><span class="line">            <span class="comment"># vocab的length不断增长</span></span><br><span class="line">            matrix[len(vocab[<span class="string">"i2w"</span>])<span class="number">-1</span>, :] = np.array([float(x) <span class="keyword">for</span> x <span class="keyword">in</span> vec[<span class="number">1</span>:]])</span><br><span class="line">    <span class="keyword">for</span> i, w <span class="keyword">in</span> enumerate(vocab[<span class="string">"i2w"</span>]):</span><br><span class="line">        vocab[<span class="string">"w2i"</span>][w] = i</span><br><span class="line">    <span class="keyword">return</span> matrix, vocab, size</span><br></pre></td></tr></table></figure>
<ol>
<li>词表重复问题，是实际加载词向量中遇到的比较麻烦的问题，重复的词表导致无法用字典来索引每个词对应的词向量，所以上一步的词向量加载，实际上应该考虑重复问题：</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_dense_drop_repeat</span><span class="params">(path)</span>:</span></span><br><span class="line">    vocab_size, size = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    vocab = &#123;&#125;</span><br><span class="line">    vocab[<span class="string">"i2w"</span>], vocab[<span class="string">"w2i"</span>] = [], &#123;&#125;</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> codecs.open(path, <span class="string">"r"</span>, <span class="string">"utf-8"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        first_line = <span class="keyword">True</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            <span class="keyword">if</span> first_line:</span><br><span class="line">                first_line = <span class="keyword">False</span></span><br><span class="line">                vocab_size = int(line.strip().split()[<span class="number">0</span>])</span><br><span class="line">                size = int(line.rstrip().split()[<span class="number">1</span>])</span><br><span class="line">                matrix = np.zeros(shape=(vocab_size, size), dtype=np.float32)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            vec = line.strip().split()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> vocab[<span class="string">"w2i"</span>].__contains__(vec[<span class="number">0</span>]):</span><br><span class="line">                vocab[<span class="string">"w2i"</span>][vec[<span class="number">0</span>]] = count</span><br><span class="line">                matrix[count, :] = np.array([float(x) <span class="keyword">for</span> x <span class="keyword">in</span> vec[<span class="number">1</span>:]])</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> w, i <span class="keyword">in</span> vocab[<span class="string">"w2i"</span>].items():</span><br><span class="line">        vocab[<span class="string">"i2w"</span>].append(w)</span><br><span class="line">    <span class="keyword">return</span> matrix, vocab, size, len(vocab[<span class="string">"i2w"</span>])</span><br></pre></td></tr></table></figure>
<ol>
<li>如何将得到的此向量矩阵matrix载入到torch中的embedding中？（上一步中，为了减少每次读matrix的耗时，可以将matrix用numpy保存到npy文件）:</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">emb = np.load(emb)</span><br><span class="line">print(<span class="string">'emb的shape:'</span>, emb.shape)</span><br><span class="line">self.embedding = nn.Embedding(vocab_size, embedding_size)</span><br><span class="line">self.embedding.weight.data.copy_(torch.from_numpy(emb))</span><br><span class="line">self.embedding.weight.requires_grad = <span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h2 id="4-总结"><a href="#4-总结" class="headerlink" title="4. 总结"></a>4. 总结</h2><p>总的来看<a href="https://github.com/Embedding/Chinese-Word-Vectors" target="_blank" rel="noopener">Chinese-Word-Vectors</a>预训练数据是有其价值的，减少了很多的训练资源。但是由于自然语言处理的文本本身具有非常大的噪声，很难保证词向量是完美的、不包含任何错字和重复。</p>
<p>在使用<a href="https://github.com/Embedding/Chinese-Word-Vectors" target="_blank" rel="noopener">Chinese-Word-Vectors</a>过程中，尽量要匹配好自己的需求。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/通用论坛正文提取/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/通用论坛正文提取/" itemprop="url">通用论坛正文提取</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T10:46:09+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web-spiders/" itemprop="url" rel="index">
                    <span itemprop="name">Web spiders</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本人长期出售超大量微博数据、旅游网站评论数据，并提供各种指定数据爬取服务，Message to YuboonaZhang@Yahoo.com。同时欢迎加入社交媒体数据交流群：99918768</p>
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><blockquote>
<p>参加泰迪杯数据挖掘竞赛，这次真的学习到了不少东西，最后差不多可以完成要求的内容，准确率也还行。总共的代码，算上中间的过程处理也不超过500行，代码思想也还比较简单，主要是根据论坛的短文本特性和楼层之间内容的相似来完成的。(通俗点说就是去噪去噪去噪，然后只留下相对有规律的日期，内容)</p>
</blockquote>
<h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><ol>
<li><p>软件和开发环境： Pycharm，Python2.7，Linux系统</p>
</li>
<li><p>用的主要Python包： jieba， requests， BeautifulSoup， goose， selenium， PhantomJS， pymongo等(部分软件的安装我前面的博客有介绍)</p>
</li>
</ol>
<h2 id="网页预处理"><a href="#网页预处理" class="headerlink" title="网页预处理"></a>网页预处理</h2><p>首先因为网站很多是动态的，直接用bs4是获取不到有些信息的，所以我们使用selenium和phantomjs将文件保存在本地，然后再处理。</p>
<p>相关的代码是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(baseUrl)</span>:</span></span><br><span class="line">    driver = webdriver.PhantomJS()</span><br><span class="line">    driver.get(baseUrl) <span class="comment"># seconds</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        element = WebDriverWait(driver, <span class="number">10</span>).until(isload(driver) <span class="keyword">is</span> <span class="keyword">True</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception, e:</span><br><span class="line">        <span class="keyword">print</span> e</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        data = driver.page_source  <span class="comment"># 取到加载js后的页面content</span></span><br><span class="line">    driver.quit()</span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>
<p>由于网页中存在着大量的噪音（广告，图片等），首先我们需要将与我们所提取内容不一致的所有噪声尽可能去除。我们首先选择将一些带有典型噪声意义的噪声标签去除，比如script等，方法我们选择BeautifulSoup来完成。</p>
<p>代码大概是这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> soup(text=<span class="keyword">lambda</span> text: isinstance(text, Comment)):</span><br><span class="line">    element.extract()</span><br><span class="line"></span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'script'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'meta'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'style'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'link'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'img'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'input'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'br'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'li'</span>)]</span><br><span class="line">[s.extract() <span class="keyword">for</span> s <span class="keyword">in</span> soup(<span class="string">'ul'</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (soup.prettify())</span><br></pre></td></tr></table></figure>
<p>处理之后的网页对比</p>
<p><img src="http://111.230.251.140:8000/images/before.png" alt="之前"></p>
<p><img src="http://111.230.251.140:8000/images/after.png" alt="之后"></p>
<p>可以看出网页噪声少了很多，但是还是不足以从这么多噪声中提取出我们所要的内容</p>
<p>由于我们不需要标签只需要标签里面的文字,所以我们可以利用BeautifulSoup提取出文字内容再进行分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> string <span class="keyword">in</span> soup.stripped_strings:</span><br><span class="line">    print(string)</span><br><span class="line">    <span class="keyword">with</span> open(os.path.join(os.getcwd())+<span class="string">"/data/3.txt"</span>, <span class="string">'a'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.writelines(string.encode(<span class="string">'utf-8'</span>)+<span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://111.230.251.140:8000/images/3txt.png" alt="去除噪声标签之后的信息"></p>
<p>可以看出来还是非常杂乱，但是又是十分有规律的。我们可以发现每个楼层中的文本内容实质上都差不多，可以说重复的很多，而且都是一些特定的词，比如: <strong>直达楼层</strong>, <strong>板凳</strong>,<strong>沙发</strong>,等这类的词，所以我们需要将这些词删掉然后再进行分析</p>
<p>我所用的方法是利用jieba分词来对获取的网页文本进行分词，统计出出现词频最高的词，同时也是容易出现在噪声文章中的词语，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jieba.analyse</span><br><span class="line"></span><br><span class="line">text = open(<span class="string">r"./data/get.txt"</span>, <span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">cut = jieba.cut_for_search(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fc <span class="keyword">in</span> cut:</span><br><span class="line">    <span class="keyword">if</span> fc <span class="keyword">in</span> dic:</span><br><span class="line">        dic[fc] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dic[fc] = <span class="number">1</span></span><br><span class="line">blog = jieba.analyse.extract_tags(text, topK=<span class="number">1000</span>, withWeight=<span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> word_weight <span class="keyword">in</span> blog:</span><br><span class="line">    <span class="comment"># print (word_weight[0].encode('utf-8'), dic.get(word_weight[0], 'not found'))</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'cut.txt'</span>, <span class="string">'a'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.writelines(word_weight[<span class="number">0</span>].encode(<span class="string">'utf-8'</span>) + <span class="string">"    "</span> + str(dic.get(word_weight[<span class="number">0</span>], <span class="string">'not found'</span>)) + <span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure>
<p>统计出来然后经过我们测试和筛选得出的停用词有这些</p>
<blockquote>
<p>回帖<br>积分<br>帖子<br>登录<br>论坛<br>注册<br>离线<br>时间<br>作者<br>签到<br>主题<br>精华<br>客户端<br>手机<br>下载<br>分享</p>
</blockquote>
<p>目前统计的词大约200左右。</p>
<p>然后还有去除重复文本的工作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 去重函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_dup</span><span class="params">(items)</span>:</span></span><br><span class="line">    pattern1 = re.compile(<span class="string">r'发表于'</span>)</span><br><span class="line">    pattern2 = re.compile(<span class="string">'\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125; \d&#123;2&#125;:\d&#123;2&#125;:\d&#123;2&#125;'</span>)</span><br><span class="line">    pattern3 = re.compile(<span class="string">'\d&#123;1,2&#125;-\d&#123;1,2&#125; \d&#123;2&#125;:\d&#123;2&#125;'</span>)</span><br><span class="line">    pattern4 = re.compile(<span class="string">'\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125; \d&#123;2&#125;:\d&#123;2&#125;'</span>)</span><br><span class="line">    pattern5 = re.compile(<span class="string">r'[^0-9a-zA-Z]&#123;7,&#125;'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 用集合来作为容器，来做一部分的重复判断依据，另外的部分由匹配来做</span></span><br><span class="line">    <span class="comment"># yield用于将合适的文本用生成器得到迭代器，这样就进行了文本的删除，在函数外面</span></span><br><span class="line">    <span class="comment"># 可以用函数进行文本的迭代</span></span><br><span class="line">    seen = set()</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">        match1 = pattern1.match(item)</span><br><span class="line">        match2 = pattern2.match(item)</span><br><span class="line">        match3 = pattern3.match(item)</span><br><span class="line">        match4 = pattern4.match(item)</span><br><span class="line">        match5 = pattern5.match(item)</span><br><span class="line">        <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> seen <span class="keyword">or</span> match1 <span class="keyword">or</span> match2 <span class="keyword">or</span> match3 <span class="keyword">or</span> match4 <span class="keyword">or</span> match5:</span><br><span class="line">            <span class="keyword">yield</span> item</span><br><span class="line">        seen.add(item)  <span class="comment"># 向集合中加入item，集合会自动化删除掉重复的项目</span></span><br></pre></td></tr></table></figure>
<p>在经过观察处理后的网页文本，我们发现还有一项噪声无法忽略，那就是纯数字。因为网页文本中有很多纯数字但是又不重复，比如<strong>点赞数</strong>等，所以我准备用正则匹配出纯数字然后删除。但是这样就会出现问题…因为有些用户名是纯数字的，这样我们会把用户名删掉的。为了解决这个问题我们使用保留字符数大于7的纯数字，这样既删除了大部分的没用信息又尽可能的保留了用户名</p>
<p>相关的代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">st = []</span><br><span class="line">    <span class="keyword">for</span> stop_word <span class="keyword">in</span> stop_words:</span><br><span class="line">        st.append(stop_word.strip(<span class="string">'\n'</span>))</span><br><span class="line">    t = tuple(st)</span><br><span class="line">    <span class="comment"># t,元组，和列表的区别是，不能修改使用（，，，，），与【，，，】列表不同</span></span><br><span class="line">    lines = []</span><br><span class="line">    <span class="comment"># 删除停用词和短数字实现</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> after_string:</span><br><span class="line">        <span class="comment"># 如果一行的开头不是以停用词开头，那么读取这一行</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> j.startswith(t):</span><br><span class="line">            <span class="comment"># 如何一行不全是数字，或者这行的数字数大于7（区别无关数字和数字用户名）读取这一行</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">'\d+$'</span>, j) <span class="keyword">or</span> len(j) &gt; <span class="number">7</span>:</span><br><span class="line">                lines.append(j.strip())</span><br><span class="line">                <span class="comment"># 删除所有空格并输出</span></span><br><span class="line">                <span class="keyword">print</span> (j.strip())</span><br></pre></td></tr></table></figure>
<p>处理之后的文本如下，规律十分明显了</p>
<p><img src="http://111.230.251.140:8000/images/aftertxt.png" alt="去除噪声标签之后的信息"></p>
<p>接下来就是我们进行内容提取的时候了</p>
<h2 id="内容提取"><a href="#内容提取" class="headerlink" title="内容提取"></a>内容提取</h2><p>内容提取无非是找到评论块，而评论块在上面我们的图中已经十分清晰了，我们自然而然的想到根据日期来区分评论块。经过观察，所有的论坛中日期的形式只有5种（目前只看到5种，当然后期可以加上）。我们可以用正则匹配出日期所在的行，根据两个日期所在行数的中间所夹的就是评论内容和用户名来完成我们的评论内容提取。</p>
<p>传入我们处理后的文本然后就匹配出日期所在行数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 匹配日期返回get_list</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">match_date</span><span class="params">(lines)</span>:</span></span><br><span class="line">    pattern1 = re.compile(<span class="string">r'发表于'</span>)</span><br><span class="line">    pattern2 = re.compile(<span class="string">'\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125; \d&#123;2&#125;:\d&#123;2&#125;:\d&#123;2&#125;'</span>)</span><br><span class="line">    pattern3 = re.compile(<span class="string">'\d&#123;1,2&#125;-\d&#123;1,2&#125; \d&#123;2&#125;:\d&#123;2&#125;'</span>)</span><br><span class="line">    pattern4 = re.compile(<span class="string">'\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125; \d&#123;2&#125;:\d&#123;2&#125;'</span>)</span><br><span class="line">    pattern5 = re.compile(<span class="string">r'发表日期'</span>)</span><br><span class="line"></span><br><span class="line">    pre_count = <span class="number">-1</span></span><br><span class="line">    get_list = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 匹配日期文本</span></span><br><span class="line">    <span class="keyword">for</span> string <span class="keyword">in</span> lines:</span><br><span class="line">        match1 = pattern1.match(string)</span><br><span class="line">        match2 = pattern2.match(string)</span><br><span class="line">        match3 = pattern3.match(string)</span><br><span class="line">        match4 = pattern4.match(string)</span><br><span class="line">        match5 = pattern5.match(string)</span><br><span class="line">        pre_count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> match1 <span class="keyword">or</span> match2 <span class="keyword">or</span> match3 <span class="keyword">or</span> match4 <span class="keyword">or</span> match5:</span><br><span class="line">            get_dic = &#123;<span class="string">'count'</span>: pre_count, <span class="string">'date'</span>: string&#125;</span><br><span class="line">            get_list.append(get_dic)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回的是匹配日期后的信息</span></span><br><span class="line">    <span class="keyword">return</span> get_list</span><br></pre></td></tr></table></figure>
<p>因为有回帖和没有回帖处理方式也不一样所以我们需要分类进行讨论。因为我们知道评论的内容是在两个匹配日期的中间，这样就有一个问题就是最后一个评论的内容区域不好分。但是考虑到大部分的最后一个回帖都是一行我们可以暂取值为3（sub==3，考虑一行评论和一行用户名），后来想到一种更为科学的方法，比如判断后面几行的文本密度，如果很小说明只有一行评论的可能性更大。</p>
<p>下面的代码是获取日期所在行数和两个日期之间的行数差</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 返回my_count</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_count</span><span class="params">(get_list)</span>:</span></span><br><span class="line">    my_count = []</span><br><span class="line">    date = []</span><br><span class="line">    <span class="comment"># 获取时间所在行数</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> get_list:</span><br><span class="line">        k, t = i.get(<span class="string">'count'</span>), i.get(<span class="string">'date'</span>)</span><br><span class="line">        my_count.append(k)</span><br><span class="line">        date.append(t)</span><br><span class="line">    <span class="keyword">if</span> len(get_list) &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 最后一行暂时取3</span></span><br><span class="line">        my_count.append(my_count[<span class="number">-1</span>] + <span class="number">3</span>)</span><br><span class="line">        <span class="keyword">return</span> my_count</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> my_count</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取两个时间所在的行数差</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_sub</span><span class="params">(my_count)</span>:</span></span><br><span class="line">    sub = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(my_count) - <span class="number">1</span>):</span><br><span class="line">        sub.append(my_count[i + <span class="number">1</span>] - my_count[i])</span><br><span class="line">    <span class="keyword">return</span> sub</span><br></pre></td></tr></table></figure>
<p>接下来就要分类讨论了</p>
<ol>
<li><p>如果只有楼主没有评论（即my——count==1），这个时候我们可以使用开源的正文提取软件goose来提取正文。</p>
</li>
<li><p>如果有评论我们就需要根据sub的值来进行分类如果sub==2占多数（或者说比sub==3）占的多，那么我们就认为可能是用户名被删掉，删掉的原因有很多，比如去重的时候有人在楼中楼回复了导致用户名重复被删除，有可能该网站的标签比较特殊用户名在去标签的时候删除等，情况比较复杂且出现的频率不太高，暂未考虑。何况不影响我们提取评论内容，只需分类出来考虑就行</p>
</li>
</ol>
<font color="#FF0000" size="4" face="黑体"><br>注意：下面余弦相似度这个是我开始的时候想多了！大部分情况就是：日期-评论-用户名，后来我没有考虑余弦相似度分类，代码少了，精度也没有下降。这里不删是想留下一个思考的过程。代码看看就好，最后有修改后的源码。<br></font>

<ol>
<li>还有就是最常见的内容，就是sub==3占多数的情况。因为大部分的评论都是一行文本，所以我们需要考虑的的是sub==3的时候获取的评论文本在哪一行。通俗来说就是这三行的内容是<strong>日期-评论-用户名</strong>，还是<strong>日期-用户名-评论</strong>呢？虽然大部分是第一种情况，但是第二种情况我们也不能忽略。怎么判断这两种情况呢？这确实让我思考了很长一段时间，后来想到可以用余弦相似度来解决这个问题.科普余弦相似度可以看<a href="http://www.ruanyifeng.com/blog/2013/03/cosine_similarity.html" target="_blank" rel="noopener">这里</a>。简单来说就是用户名的长度都是相似的，但是评论的内容长度差异就非常大了。比如用户名长度都是7个字符左右，但是评论的长度可以数百，也可以只有一个。所以我们可以两两比较余弦相似度，然后取平均，相似度大的就是用户名了。这样我们就可以区分出评论内容进行提取了！这就是主要的思想。剩下的就是代码的实现了。</li>
</ol>
<p>简单贴一下相关的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用goose获取正文内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goose_content</span><span class="params">(my_count, lines, my_url)</span>:</span></span><br><span class="line">    g = Goose(&#123;<span class="string">'stopwords_class'</span>: StopWordsChinese&#125;)</span><br><span class="line">    content_1 = g.extract(url=my_url)</span><br><span class="line">    host = &#123;&#125;</span><br><span class="line">    my_list = []</span><br><span class="line">    host[<span class="string">'content'</span>] = content_1.cleaned_text</span><br><span class="line">    host[<span class="string">'date'</span>] = lines[my_count[<span class="number">0</span>]]</span><br><span class="line">    host[<span class="string">'title'</span>] = get_title(my_url)</span><br><span class="line">    result = &#123;<span class="string">"post"</span>: host, <span class="string">"replys"</span>: my_list&#125;</span><br><span class="line">    SpiderBBS_info.insert(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算余弦相似度函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cos_dist</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> len(a) != len(b):</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line">    part_up = <span class="number">0.0</span></span><br><span class="line">    a_sq = <span class="number">0.0</span></span><br><span class="line">    b_sq = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> a1, b1 <span class="keyword">in</span> zip(a, b):</span><br><span class="line">        part_up += a1 * b1</span><br><span class="line">        a_sq += a1 ** <span class="number">2</span></span><br><span class="line">        b_sq += b1 ** <span class="number">2</span></span><br><span class="line">    part_down = math.sqrt(a_sq * b_sq)</span><br><span class="line">    <span class="keyword">if</span> part_down == <span class="number">0.0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> part_up / part_down</span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断评论内容在哪一行（可能在3行评论块的中间，可能在三行评论块的最后）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_3_comment</span><span class="params">(my_count, lines)</span>:</span></span><br><span class="line">    get_pd_1 = []</span><br><span class="line">    get_pd_2 = []</span><br><span class="line">    <span class="comment"># 如果间隔为3取出所在行的文本长度</span></span><br><span class="line">    test_sat_1 = []</span><br><span class="line">    test_sat_2 = []</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> range(len(my_count)<span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">if</span> my_count[num+<span class="number">1</span>] - <span class="number">3</span> == my_count[num]:</span><br><span class="line">            pd_1 = (len(lines[my_count[num]]), len(lines[my_count[num]+<span class="number">2</span>]))</span><br><span class="line">            get_pd_1.append(pd_1)</span><br><span class="line">            pd_2 = (len(lines[my_count[num]]), len(lines[my_count[num]+<span class="number">1</span>]))</span><br><span class="line">            get_pd_2.append(pd_2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i_cos <span class="keyword">in</span> range(len(get_pd_1)<span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">for</span> j_cos <span class="keyword">in</span> range(i_cos+<span class="number">1</span>, len(get_pd_1)):</span><br><span class="line">            <span class="comment"># 计算文本余弦相似度</span></span><br><span class="line">            test_sat_1.append(cos_dist(get_pd_1[j_cos], get_pd_1[i_cos]))</span><br><span class="line">            test_sat_2.append(cos_dist(get_pd_2[j_cos], get_pd_2[i_cos]))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算余弦相似度的平均值</span></span><br><span class="line">    get_mean_1 = numpy.array(test_sat_1)</span><br><span class="line">    <span class="keyword">print</span> (get_mean_1.mean())</span><br><span class="line">    get_mean_2 = numpy.array(test_sat_2)</span><br><span class="line">    <span class="keyword">print</span> (get_mean_2.mean())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 比较大小返回是否应该按</span></span><br><span class="line">    <span class="keyword">if</span> get_mean_1.mean() &gt;= get_mean_2.mean():</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> get_mean_1.mean() &lt; get_mean_2.mean():</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取评论内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve__3</span><span class="params">(num, my_count, sub, lines, my_url)</span>:</span></span><br><span class="line">    <span class="comment"># 如果get_3_comment()返回的值是1，那么说明最后一行是用户名的可能性更大，否则第一行是用户名的可能性更大</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">1</span>:</span><br><span class="line">        host = &#123;&#125;</span><br><span class="line">        my_list = []</span><br><span class="line">        host[<span class="string">'content'</span>] = <span class="string">''</span>.join(lines[my_count[<span class="number">0</span>]+<span class="number">1</span>: my_count[<span class="number">1</span>]+sub[<span class="number">0</span>]<span class="number">-1</span>])</span><br><span class="line">        host[<span class="string">'date'</span>] = lines[my_count[<span class="number">0</span>]]</span><br><span class="line">        host[<span class="string">'title'</span>] = get_title(my_url)</span><br><span class="line">        <span class="keyword">for</span> use <span class="keyword">in</span> range(<span class="number">1</span>, len(my_count)<span class="number">-1</span>):</span><br><span class="line">            pl = &#123;<span class="string">'content'</span>: <span class="string">''</span>.join(lines[my_count[use] + <span class="number">1</span>:my_count[use + <span class="number">1</span>] - <span class="number">1</span>]), <span class="string">'date'</span>: lines[my_count[use]],</span><br><span class="line">                  <span class="string">'title'</span>: get_title(my_url)&#125;</span><br><span class="line">            my_list.append(pl)</span><br><span class="line"></span><br><span class="line">        result = &#123;<span class="string">"post"</span>: host, <span class="string">"replys"</span>: my_list&#125;</span><br><span class="line">        SpiderBBS_info.insert(result)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">2</span>:</span><br><span class="line">        host = &#123;&#125;</span><br><span class="line">        my_list = []</span><br><span class="line">        host[<span class="string">'content'</span>] = <span class="string">''</span>.join(lines[my_count[<span class="number">0</span>]+<span class="number">2</span>: my_count[<span class="number">1</span>]+sub[<span class="number">0</span>]])</span><br><span class="line">        host[<span class="string">'date'</span>] = lines[my_count[<span class="number">0</span>]]</span><br><span class="line">        host[<span class="string">'title'</span>] = get_title(my_url)</span><br><span class="line">        <span class="keyword">for</span> use <span class="keyword">in</span> range(<span class="number">1</span>, len(my_count) - <span class="number">1</span>):</span><br><span class="line">            pl = &#123;<span class="string">'content'</span>: <span class="string">''</span>.join(lines[my_count[use] + <span class="number">2</span>:my_count[use + <span class="number">1</span>]]), <span class="string">'date'</span>: lines[my_count[use]],</span><br><span class="line">                  <span class="string">'title'</span>: get_title(my_url)&#125;</span><br><span class="line">            my_list.append(pl)</span><br><span class="line"></span><br><span class="line">        result = &#123;<span class="string">"post"</span>: host, <span class="string">"replys"</span>: my_list&#125;</span><br><span class="line">        SpiderBBS_info.insert(result)</span><br></pre></td></tr></table></figure>
<h2 id="展望"><a href="#展望" class="headerlink" title="展望"></a>展望</h2><p>提取的准确率应该要分析更多的bbs网站，优化删除重复词（太粗暴），优化停用词，针对短文本没回复情况的优化，准确提取楼主的用户名等，无奈时间太紧无法进一步优化。才疏学浅，刚学了几个月python，代码难免有不合理的地方，望各位提出宝贵意见。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/使用Dlib、PyQt搭建人脸识别系统/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/使用Dlib、PyQt搭建人脸识别系统/" itemprop="url">使用Dlib、PyQt搭建人脸识别系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T10:46:07+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="使用Dlib、PyQt搭建人脸识别系统"><a href="#使用Dlib、PyQt搭建人脸识别系统" class="headerlink" title="使用Dlib、PyQt搭建人脸识别系统"></a>使用Dlib、PyQt搭建人脸识别系统</h1><h2 id="１、软硬件需求"><a href="#１、软硬件需求" class="headerlink" title="１、软硬件需求"></a>１、软硬件需求</h2><ol>
<li><p>开发及实验平台(windows也是一样的)<br> Ubuntu 16.04.1 x64；内核版本：4.8.0-36-generic</p>
</li>
<li><p>软件配置<br> 数据库: Python 模块Sqlite3版本：3.11.0<br> Python版本：3.5<br> PyQt5版本：5.10.1<br> Python模块Dlib版本：19.9.0<br> Python模块Opencv版本：3.4.0.12<br> Python 模块face-recognition版本：1.2.2<br> Python模块 numpy版本：1.14.2<br> Python模块 pandas版本：0.22.0</p>
</li>
<li><p>硬件<br> 测试机：thinkpad E440<br> 摄像头：电脑自带720p HD摄像头</p>
</li>
</ol>
<p>注意:**所有软件配置中python模块的安装都可以使用<figure class="highlight plain"><figcaption><span>insatll '模块名称'```完成，[pip安装方式][1]，但是Dib安装的时候需要系统满足一定条件才能安装，[ubuntu安装Dlib][2]/[windows安装Dlib][3]**</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## ２、什么是PyQt</span><br><span class="line"></span><br><span class="line">PyQt是一个图形化软件开发的库，基于python，使用方便而且功能完善。</span><br><span class="line"></span><br><span class="line">## ３、人脸识别功能的实现</span><br><span class="line"></span><br><span class="line">### 如何识别人脸</span><br><span class="line"></span><br><span class="line">简单的识别人脸可以借助face-recognition这个python模块中的接口实现，这个模块内部调用了Dlib来实现人脸识别，但是它对Dlib的使用比较粗糙，有很多可以我们自由改进。在进阶方案中我们可以自己来修改face-recognition的源码达到改善识别效果的目的。</span><br><span class="line">下面用一个[例子][4]来介绍face-recognition的使用：</span><br><span class="line">```python</span><br><span class="line">import face_recognition</span><br><span class="line">import cv2</span><br><span class="line"></span><br><span class="line"># 开启摄像头</span><br><span class="line">video_capture = cv2.VideoCapture(0)</span><br><span class="line"></span><br><span class="line"># 载入一张已知的照片作为识别的先验参照，不然没有办法分辨谁是谁，这张照片可以放在当前文件夹中</span><br><span class="line">obama_image = face_recognition.load_image_file(&quot;已知人脸的图片.jpg&quot;)</span><br><span class="line"># 使用face_recognition模块把已知人脸图片的编码取出来</span><br><span class="line">face_encoding1 = face_recognition.face_encodings(obama_image)[0]</span><br><span class="line"></span><br><span class="line"># 载入第二张已知的照片作为识别的先验参照，这张照片可以放在当前文件夹中</span><br><span class="line">biden_image = face_recognition.load_image_file(&quot;已知人脸的图片2.jpg&quot;)</span><br><span class="line"># 使用face_recognition模块把已知人脸图片的编码取出来，</span><br><span class="line">face_encoding2 = face_recognition.face_encodings(biden_image)[0]</span><br><span class="line"></span><br><span class="line"># 用列表把已经编码的已知人脸特征编码存起来</span><br><span class="line">known_face_encodings = [</span><br><span class="line">    face_encoding1,</span><br><span class="line">    face_encoding2</span><br><span class="line">]</span><br><span class="line"># 把名字按顺序存起来</span><br><span class="line">known_face_names = [</span><br><span class="line">    &quot;名字1&quot;,</span><br><span class="line">    &quot;名字2&quot;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 准备一些变量</span><br><span class="line">face_locations = []</span><br><span class="line">face_encodings = []</span><br><span class="line">face_names = []</span><br><span class="line">process_this_frame = True</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    # 获取一帧摄像头图像</span><br><span class="line">    ret, frame = video_capture.read()</span><br><span class="line"></span><br><span class="line">    # 将图像缩小为原来的1/4这样处理起来比较快</span><br><span class="line">    small_frame = cv2.resize(frame, (0, 0), fx=0.25, fy=0.25)</span><br><span class="line"></span><br><span class="line">    # 这行代码将图像从BGR（opencv当前从摄像头获取的图片，以这种颜色格式存储着）转化为RGB(等会用到的颜色是这种颜色)</span><br><span class="line">    rgb_small_frame = small_frame[:, :, ::-1]</span><br><span class="line"></span><br><span class="line">    # 只处理process_this_frame = True的帧，减少计算量</span><br><span class="line">    if process_this_frame:</span><br><span class="line">        # 找到当前摄像头中所有的人脸的位置，把这些位置保存起来</span><br><span class="line">        face_locations = face_recognition.face_locations(rgb_small_frame)</span><br><span class="line">        # 将找到的人脸都编码为人脸特征编码</span><br><span class="line">        face_encodings = face_recognition.face_encodings(rgb_small_frame, face_locations)</span><br><span class="line"></span><br><span class="line">        face_names = []</span><br><span class="line">        # 查找摄像头中的人脸与已知人脸中的哪一个最为相像</span><br><span class="line">        for face_encoding in face_encodings:</span><br><span class="line">            matches = face_recognition.compare_faces(known_face_encodings, face_encoding)</span><br><span class="line">            name = &quot;Unknown&quot;</span><br><span class="line"></span><br><span class="line">            # 使用所有匹配的人脸中排序最先的那一个作为身份</span><br><span class="line">            if True in matches:</span><br><span class="line">                first_match_index = matches.index(True)</span><br><span class="line">                name = known_face_names[first_match_index]</span><br><span class="line"></span><br><span class="line">            face_names.append(name)</span><br><span class="line"></span><br><span class="line">    process_this_frame = not process_this_frame</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # 将识别结果在展示在一个窗口中</span><br><span class="line">    for (top, right, bottom, left), name in zip(face_locations, face_names):</span><br><span class="line">        # 将人脸位置放大四倍，因为之前缩小了</span><br><span class="line">        top *= 4</span><br><span class="line">        right *= 4</span><br><span class="line">        bottom *= 4</span><br><span class="line">        left *= 4</span><br><span class="line"></span><br><span class="line">        # 用刚才得到的人脸位置在图像中画出方框框住人脸</span><br><span class="line">        cv2.rectangle(frame, (left, top), (right, bottom), (0, 0, 255), 2)</span><br><span class="line"></span><br><span class="line">        # 在人脸框的下面画上一个方框，放识别出来的名字</span><br><span class="line">        cv2.rectangle(frame, (left, bottom - 35), (right, bottom), (0, 0, 255), cv2.FILLED)</span><br><span class="line">        font = cv2.FONT_HERSHEY_DUPLEX</span><br><span class="line">        cv2.putText(frame, name, (left + 6, bottom - 6), font, 1.0, (255, 255, 255), 1)</span><br><span class="line"></span><br><span class="line">    # 显示出身份识别结果</span><br><span class="line">    cv2.imshow(&apos;Video&apos;, frame)</span><br><span class="line"></span><br><span class="line">    # 设置按&apos;q&apos;建就会退出</span><br><span class="line">    if cv2.waitKey(1) &amp; 0xFF == ord(&apos;q&apos;):</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line"># 释放摄像头</span><br><span class="line">video_capture.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure></p>
<p>通过以上的代码可以了解如何使用face-recognition这一模块来进行人脸识别。</p>
<h3 id="使用PyQt"><a href="#使用PyQt" class="headerlink" title="使用PyQt"></a>使用PyQt</h3><h4 id="1-设计PyQt界面"><a href="#1-设计PyQt界面" class="headerlink" title="(1)设计PyQt界面"></a>(1)设计PyQt界面</h4><p>Qt5界面可以使用Qt designer这一工具进行设计，但是PyQt5的界面有没有简便的工具呢。事实上PyQt5也使用Qt designer这一工具，在设计完成之后，可以使用pyuic工具转换为python可以使用的界面文件<br><img src="/2020/01/12/使用Dlib、PyQt搭建人脸识别系统/2018-06-18.png" alt="人脸识别界面"><br>如图所示为我用Qt designer设计的一个界面.ui文件，使用如下的命令将界面源码转换为.py格式的PyQt可以使用的界面文件face_check.py</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyuic -x -o face_check.py face_check.py</span><br></pre></td></tr></table></figure>
<h4 id="2-为界面添加交互"><a href="#2-为界面添加交互" class="headerlink" title="(2)为界面添加交互"></a>(2)为界面添加交互</h4><p>但是有了界面之后，人机交互应该如何实现呢，这需要涉及到PyQt的交互机制，下面的代码展示了为“开始”按钮增加一个点击事件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__author__ = <span class="string">'Zhang Zhe'</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PyQt5 <span class="keyword">import</span> QtWidgets</span><br><span class="line"><span class="keyword">from</span> face_check <span class="keyword">import</span> Ui_FaceCheck</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个新的类，这个类继承由Qt designer生成的界面类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FaceCheck</span><span class="params">(QtWidgets.QDialog, Ui_FaceCheck)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, parent=None)</span>:</span></span><br><span class="line">        <span class="comment"># 用来调用基类中的初始化函数</span></span><br><span class="line">        super(FaceCheck, self).__init__()</span><br><span class="line">        self.setupUi(self)</span><br><span class="line">        <span class="comment"># 通过将“开始”按钮与onStartBtnClicked()函数连接起来，为“开始”按钮增加点击事件</span></span><br><span class="line">        self.start.clicked.connect(self.onStartBtnClicked)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">onStartBtnClicked</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        登录的点击事件</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># 开始按钮的点击事件只输出一句话“这是开始按钮”，这句话将被输出到控制台的输出中</span></span><br><span class="line">        print(<span class="string">"这是开始按钮！！！"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app = QtWidgets.QApplication(sys.argv)</span><br><span class="line">    FaceCheck = FaceCheck()</span><br><span class="line">    FaceCheck.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure>
<p>PyQt中提供了和Qt一样的信号槽机制。对于按钮来说，其默认有一个clicked事件可以连接</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/解决CMAKE编译第三方开源软件需要下载的问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/解决CMAKE编译第三方开源软件需要下载的问题/" itemprop="url">解决CMAKE编译第三方开源软件需要下载的问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T10:46:03+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编译开源软件/" itemprop="url" rel="index">
                    <span itemprop="name">编译开源软件</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本人长期出售超大量微博数据、旅游网站评论数据，并提供各种指定数据爬取服务，Message to YuboonaZhang@Yahoo.com。同时欢迎加入社交媒体数据交流群：99918768</p>
<h1 id="解决CMAKE编译第三方开源软件需要下载的问题"><a href="#解决CMAKE编译第三方开源软件需要下载的问题" class="headerlink" title="解决CMAKE编译第三方开源软件需要下载的问题"></a>解决CMAKE编译第三方开源软件需要下载的问题</h1><p>经常会出现这种问题：我们从github上面下载了一些开源软件，但是这个开源软件<strong>本身其实是会下载很多其他开源软件</strong>，编译后作为软件的一部分。<br>看起来好像没什么问题，但是有时候这个下载很耗时间，让整个安装变得很慢，它本身的这个下载过程下载东西真的很不稳定。所以就导致了有可能的安装失败。重新多次安装又要多次下载，这个过程真的很浪费时间和网络资源硬盘资源。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>通过对于我最近使用的一个软件的cmake过程的研究，发现这个软件安装时进行第三方的包的下载的时候，是通过CMAKE自带的下载和编译功能进行的。所以为了：</p>
<ul>
<li>能够让下载第三方源码的过程被消除</li>
<li>同时为了保证不发生因为下载慢，导致的第三方的开源软件的编译的<strong>进程竞争</strong>，进而导致安装时的开源软件之间的互相依赖或者make文件不存在问题。</li>
</ul>
<h3 id="–采用网上对于CMAKE过程的修改方法"><a href="#–采用网上对于CMAKE过程的修改方法" class="headerlink" title="–采用网上对于CMAKE过程的修改方法"></a>–采用网上对于CMAKE过程的修改方法</h3><ol>
<li><p>将.cmake 文件中的以下代码<br> #–Download step————–<br> DOWNLOAD_DIR      ${SB_DOWNLOAD_DIR}<br> URL  <a href="https://github.com/gflags/gflags/archive/v2.1.2.zip" target="_blank" rel="noopener">https://github.com/gflags/gflags/archive/v2.1.2.zip</a><br> URL_MD5           5cb0a1b38740ed596edb7f86cd5b3bd8<br> 部分更改为<br> #–Download step————–<br> DOWNLOAD_COMMAND “”</p>
</li>
<li><p>同时，将src（这个文件是原本解压下载的第三方源码source的地方，具体名称要看CMakeLists.txt中SOURCE_DIR的设置）中的各个第三方源码都解压好，放到src对应的文件夹中。</p>
</li>
</ol>
<p>结果：<strong>这样整个程序编译第三方开源软件的编译过程就可以直接调用src目录中我们早就自己下载好的源码进行安装了</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/using-Electron-to-create-app-with-Js-html-css/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/using-Electron-to-create-app-with-Js-html-css/" itemprop="url">using-Electron-to-create-app-with-Js-html-css</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T10:46:01+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/App/" itemprop="url" rel="index">
                    <span itemprop="name">App</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="notes-of-Electron-Api-Demo"><a href="#notes-of-Electron-Api-Demo" class="headerlink" title="notes of Electron Api Demo"></a>notes of Electron Api Demo</h1><hr>
<p><img src="/2020/01/12/using-Electron-to-create-app-with-Js-html-css/ui-terminology.png" alt="section&amp;category"></p>
<h2 id="1-add-a-new-section-to-program"><a href="#1-add-a-new-section-to-program" class="headerlink" title="1. add a new section to program"></a>1. add a new section to program</h2><p>A <strong>category</strong> is consist of several sections, and the section is a part that contains a individual page  </p>
<p>To create a new <strong>section</strong> in code, add following code in <code>index.html</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"xxx2"</span> <span class="attr">data-section</span>=<span class="string">"xxx2"</span> <span class="attr">class</span>=<span class="string">"nav-button"</span>&gt;</span>Use system <span class="tag">&lt;<span class="name">em</span>&gt;</span>dialogs<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>in this pice of code, the real important element is <code>(1)data-section=&quot; &quot;</code> and <code>(2)class=&quot; &quot;</code></p>
<ul>
<li><p><code>(1)data-section=&quot; &quot;</code> is relevant to template file to the file of the import links in the <code>head</code> of <code>index.html</code>. for example:</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"import"</span> <span class="attr">href</span>=<span class="string">"sections/native-ui/dialogs.html"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  the file name is of no use in fact(you can choose no matter what), but it can tell what the file’s content is. The real thing makes the Electron knows what to render is this <code>data-section=&quot;xxx2&quot;</code> in <code>index.html</code>  and the <code>id=&quot;xxx2-section&quot;</code> in template file’s <code>&lt;section&gt;</code> tag.<br>  when you make <code>xxx2</code> the same in two files, then the Electron can render the correct html for <strong>section</strong></p>
</li>
<li><code>(2)class=&quot; &quot;</code> is about the style of the <strong>section</strong> looking like. In css file, it will all be defined.</li>
</ul>
<h2 id="2-add-a-demo"><a href="#2-add-a-demo" class="headerlink" title="2.add a demo"></a>2.add a demo</h2><p>We can just copy a demo code of <code>&lt;div class=&quot;demo&quot;&gt;</code> and paste to get a new <strong>demo</strong>, but the process of this <strong>demo</strong> must contain new JS action code different from the <strong>old demo</strong>.Or the new demo will just can be clicked but do nothing.  </p>
<p>We can find that when the <strong>section</strong> code be imported by the head lines in <code>index.html</code>, the JS code used in the section code also is imported together.So the same JS code will just be imported once and just for  <strong>the first section</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/python爬取图片/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/python爬取图片/" itemprop="url">python爬取图片</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T10:46:00+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web-spiders/" itemprop="url" rel="index">
                    <span itemprop="name">Web spiders</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本人长期出售超大量微博数据、旅游网站评论数据，并提供各种指定数据爬取服务，Message to YuboonaZhang@Yahoo.com。同时欢迎加入社交媒体数据交流群：99918768</p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近在做机器学习下的人脸识别的学习，机器学习这个东西有点暴力，很大程度上靠训练的数据量来决定效果。为了找数据，通过一个<a href="http://blog.csdn.net/chenriwei2/article/details/50631212" target="_blank" rel="noopener">博客</a>的指导，浏览了几个很知名的数据集。</p>
<p>几个大型数据集是通过发邮件申请进行下载，几个小型数据集直接在网页的链接下载，还有一个<a href="http://www.cs.columbia.edu/CAVE/databases/pubfig/" target="_blank" rel="noopener">Pubfig</a>数据集则是提供了大量图片的链接来让我们自己写程序来下载。</p>
<p>权衡了数据量的需求，最后选择Pubfig的数据集，于是就自己写了一个python图片采集程序，里面用了urllib和requests两种方法.</p>
<h2 id="分析Pubfig提供的下载文件的特点"><a href="#分析Pubfig提供的下载文件的特点" class="headerlink" title="分析Pubfig提供的下载文件的特点"></a>分析<a href="http://www.cs.columbia.edu/CAVE/databases/pubfig/" target="_blank" rel="noopener">Pubfig</a>提供的下载文件的特点</h2><p><img src="/2020/01/12/python爬取图片/people.png" alt="people"><br>这个数据文件提供了在数据集中出现的所有人物<br><img src="/2020/01/12/python爬取图片/urls.png" alt="urls"><br>这个数据文件提供了每个人的urls</p>
<p>可以看出来这个数据集的处理其实非常简单了，可以通过readlines的方式存进列表用空格分开一下数据就可以把urls提取出来了。</p>
<h2 id="处理一下urls文件"><a href="#处理一下urls文件" class="headerlink" title="处理一下urls文件"></a>处理一下urls文件</h2><p>urls在文件的中后部，写个文件把它单纯地提取出来，方便使用。<br>我单独把Miley_Cyrus的部分提取出来放了一个txt文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pic_url = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./Miley_Cyrus.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">        pic_url.append(i.strip(<span class="string">'\r\n'</span>))</span><br><span class="line"></span><br><span class="line">urls = []</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> pic_url:</span><br><span class="line">    _, _, _, url, _, _ = s.split()</span><br><span class="line">    urls.append(url)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入到文件里面</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'url.data'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> urls:</span><br><span class="line">        f.write(i)</span><br><span class="line">        f.write(<span class="string">'\n'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="爬取urls图片"><a href="#爬取urls图片" class="headerlink" title="爬取urls图片"></a>爬取urls图片</h2><h3 id="1-Urllibs方法"><a href="#1-Urllibs方法" class="headerlink" title="1. Urllibs方法"></a>1. Urllibs方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request <span class="keyword">as</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在同级目录新建文件夹存图片</span></span><br><span class="line">os.mkdir(<span class="string">'./img'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为请求增加一下头</span></span><br><span class="line">user_agent = <span class="string">'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.62 Safari/537.36'</span></span><br><span class="line">headers = (<span class="string">'User-Agent'</span>, user_agent)</span><br><span class="line">opener = request.build_opener()</span><br><span class="line">opener.addheaders = [headers]</span><br><span class="line">request.install_opener(opener)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定一下无响应时间，防止有的坏图片长时间没办法下载下来</span></span><br><span class="line">timeout = <span class="number">20</span></span><br><span class="line">socket.setdefaulttimeout(timeout)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从文件里面读urls</span></span><br><span class="line">urls = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./url.data'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">        <span class="keyword">if</span> i != <span class="string">''</span>:</span><br><span class="line">            urls.append(i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过urllibs的requests获取所有的图片</span></span><br><span class="line">count = <span class="number">1</span></span><br><span class="line">bad_url = []</span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">    url.rstrip(<span class="string">'\n'</span>)</span><br><span class="line">    print(url)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pic = request.urlretrieve(url, <span class="string">'./img3/%d.jpg'</span> % count)</span><br><span class="line">        print(<span class="string">'pic %d'</span> % count)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(Exception, <span class="string">':'</span>, e)</span><br><span class="line">        bad_url.append(url)</span><br><span class="line">    print(<span class="string">'\n'</span>)</span><br><span class="line">print(<span class="string">'got all photos that can be got'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 把没有抓取到的urls保存起来</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'bad_url3.data'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bad_url:</span><br><span class="line">        f.write(i)</span><br><span class="line">        f.write(<span class="string">'\n'</span>)</span><br><span class="line">    print(<span class="string">'saved bad urls'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="2-Requests方法"><a href="#2-Requests方法" class="headerlink" title="2. Requests方法"></a>2. Requests方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在同级目录新建文件夹存图片</span></span><br><span class="line">os.mkdir(<span class="string">'./img'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定一下无响应时间，防止有的坏图片长时间没办法下载下来</span></span><br><span class="line">timeout = <span class="number">20</span></span><br><span class="line">socket.setdefaulttimeout(timeout)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从文件里面读urls</span></span><br><span class="line">urls = []</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'./url.data'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">        <span class="keyword">if</span> i != <span class="string">''</span>:</span><br><span class="line">            urls.append(i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 为请求增加一下头，获取图片</span></span><br><span class="line">user_agent = <span class="string">'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.62 Safari/537.36'</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>: user_agent</span><br><span class="line">&#125;</span><br><span class="line">bad_url = []</span><br><span class="line">count = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">    url.rstrip(<span class="string">'\n'</span>)</span><br><span class="line">    print(url)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pic = requests.get(url, headers=headers)</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'./img2/%d.jpg'</span> % count, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(pic.content)</span><br><span class="line">            f.flush()</span><br><span class="line">        print(<span class="string">'pic %d'</span> % count)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(Exception, <span class="string">':'</span>, e)</span><br><span class="line">        bad_url.append(url)</span><br><span class="line">    print(<span class="string">'\n'</span>)</span><br><span class="line">print(<span class="string">'got all photos that can be got'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存坏链接</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'bad_url.data'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bad_url:</span><br><span class="line">        f.write(i)</span><br><span class="line">        f.write(<span class="string">'\n'</span>)</span><br><span class="line">    print(<span class="string">'saved bad urls'</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/MongoDB的find函数如何使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/MongoDB的find函数如何使用/" itemprop="url">MongoDB的find函数如何使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T10:45:58+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MongoDB的find函数如何使用"><a href="#MongoDB的find函数如何使用" class="headerlink" title="MongoDB的find函数如何使用"></a><strong>MongoDB的find函数如何使用</strong></h1><hr>
<h2 id="1、Why-为什么使用find-函数"><a href="#1、Why-为什么使用find-函数" class="headerlink" title="1、Why?为什么使用find()函数"></a>1、Why?为什么使用find()函数</h2><p>我在mongo中存储的数据是爬网页的json数据，结构较为复杂，json内部嵌套的很厉害，光靠眼睛来看找数据好像有点困难。pycharm上的插件提供了搜查功能，可是我发现，但仍然还是要自己用json的格式提供要搜的关键词和值。经过搜集也可以发现其实这个功能只是对find()函数的一个封装。<br>所以，我们要用find()</p>
<h2 id="2、示例数据"><a href="#2、示例数据" class="headerlink" title="2、示例数据"></a>2、示例数据</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">示例数据json:</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"_id"</span>: &#123;</span><br><span class="line">        <span class="attr">"$oid"</span>: <span class="string">"5adcae9b3fa8b06fdbe7184e"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"json"</span>: &#123;</span><br><span class="line">        <span class="attr">"sjkList"</span>: [&#123;</span><br><span class="line">            <span class="attr">"jxbmc"</span>: <span class="string">"面向对象程序设计课程设计-0022"</span>,</span><br><span class="line">            <span class="attr">"userModel"</span>: &#123;</span><br><span class="line">                <span class="attr">"roleCount"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"status"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"monitor"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"roleKeys"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"usable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"roleValues"</span>: <span class="string">""</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">"jgpxzd"</span>: <span class="string">"1"</span>,</span><br><span class="line">            <span class="attr">"totalResult"</span>: <span class="string">"0"</span>,</span><br><span class="line">            <span class="attr">"zhxs"</span>: <span class="string">"2"</span>,</span><br><span class="line">            <span class="attr">"qsz"</span>: <span class="string">"21"</span>,</span><br><span class="line">            <span class="attr">"listnav"</span>: <span class="string">"false"</span>,</span><br><span class="line">            <span class="attr">"jxb_id"</span>: <span class="string">"62DAED714DEEA4ECE0530C0114AC99EB"</span>,</span><br><span class="line">            <span class="attr">"xqdm"</span>: <span class="string">"0"</span>,</span><br><span class="line">            <span class="attr">"kcmc"</span>: <span class="string">"面向对象程序设计课程设计"</span>,</span><br><span class="line">            <span class="attr">"localeKey"</span>: <span class="string">"zh_CN"</span>,</span><br><span class="line">            <span class="attr">"sfsjk"</span>: <span class="string">"1"</span>,</span><br><span class="line">            <span class="attr">"xm"</span>: <span class="string">"孙斌"</span>,</span><br><span class="line">            <span class="attr">"xqh_id"</span>: <span class="string">"1"</span>,</span><br><span class="line">            <span class="attr">"rsdzjs"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"zzz"</span>: <span class="string">"22"</span>,</span><br><span class="line">            <span class="attr">"rangeable"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">"jxbzh"</span>: <span class="string">"117171;117172"</span>,</span><br><span class="line">            <span class="attr">"pageable"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">"queryModel"</span>: &#123;</span><br><span class="line">                <span class="attr">"totalPage"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"currentPage"</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">"totalCount"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"entityOrField"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"pageNo"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"offset"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"currentResult"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"pageSize"</span>: <span class="number">15</span>,</span><br><span class="line">                <span class="attr">"limit"</span>: <span class="number">15</span>,</span><br><span class="line">                <span class="attr">"totalResult"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"showCount"</span>: <span class="number">10</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            <span class="attr">"jxbmc"</span>: <span class="string">"自然地理与地质学实习-0003"</span>,</span><br><span class="line">            <span class="attr">"userModel"</span>: &#123;</span><br><span class="line">                <span class="attr">"roleCount"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"status"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"monitor"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"roleKeys"</span>: <span class="string">""</span>,</span><br><span class="line">                <span class="attr">"usable"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"roleValues"</span>: <span class="string">""</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">"jgpxzd"</span>: <span class="string">"1"</span>,</span><br><span class="line">            <span class="attr">"totalResult"</span>: <span class="string">"0"</span>,</span><br><span class="line">            <span class="attr">"zhxs"</span>: <span class="string">"2"</span>,</span><br><span class="line">            <span class="attr">"qsz"</span>: <span class="string">"22"</span>,</span><br><span class="line">            <span class="attr">"listnav"</span>: <span class="string">"false"</span>,</span><br><span class="line">            <span class="attr">"jxb_id"</span>: <span class="string">"5F7A59A6AB1521FDE0530B0114ACF30A"</span>,</span><br><span class="line">            <span class="attr">"xqdm"</span>: <span class="string">"0"</span>,</span><br><span class="line">            <span class="attr">"kcmc"</span>: <span class="string">"自然地理与地质学实习"</span>,</span><br><span class="line">            <span class="attr">"localeKey"</span>: <span class="string">"zh_CN"</span>,</span><br><span class="line">            <span class="attr">"sfsjk"</span>: <span class="string">"1"</span>,</span><br><span class="line">            <span class="attr">"xm"</span>: <span class="string">"孙斌"</span>,</span><br><span class="line">            <span class="attr">"xqh_id"</span>: <span class="string">"1"</span>,</span><br><span class="line">            <span class="attr">"rsdzjs"</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">"zzz"</span>: <span class="string">"23"</span>,</span><br><span class="line">            <span class="attr">"rangeable"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">"jxbzh"</span>: <span class="string">"117171;117172"</span>,</span><br><span class="line">            <span class="attr">"pageable"</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">"queryModel"</span>: &#123;</span><br><span class="line">                <span class="attr">"totalPage"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"currentPage"</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">"totalCount"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"entityOrField"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"pageNo"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"offset"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"currentResult"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"pageSize"</span>: <span class="number">15</span>,</span><br><span class="line">                <span class="attr">"limit"</span>: <span class="number">15</span>,</span><br><span class="line">                <span class="attr">"totalResult"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">"showCount"</span>: <span class="number">10</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3、find-怎么用"><a href="#3、find-怎么用" class="headerlink" title="3、find()怎么用"></a>3、find()怎么用</h2><p>find()函数的基本用法很简单</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">MongoClient[<span class="string">'你的库名'</span>][<span class="string">'你的表名'</span>].find(&#123;<span class="string">'key'</span>:<span class="string">'要搜的value'</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>但是对应实例数据，复杂json嵌套数据下这个简单的搜索方法好像没用，找了很久网页，基本都是浅尝辄止，或者介绍的和我关心的不在一个频道。</p>
<p>但是后来还是找到了正确的方法：<br>可以看到第二个关键字’json’中的嵌套了数组，数组的组成单位是json串<br>为了获得”jxb_id”: “5F7A59A6AB1521FDE0530B0114ACF30A”这个关键词对应的数据，我们可以使用如下方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">MongoClient[<span class="string">'你的库名'</span>][<span class="string">'你的表名'</span>].find(&#123;<span class="string">"json.sjkList.jxb_id"</span> : <span class="string">"5F7A59A6AB1521FDE0530B0114ACF30A"</span>&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="4、如何理解"><a href="#4、如何理解" class="headerlink" title="4、如何理解"></a>4、如何理解</h2><p>想要理解为什么会这样来用，其实看一下mongodb的一些基本的命令行操作，会有一点启发，基本都会有’.’这个操作符号，这个操作符像是在往对象的内部不断地纵深。</p>
<p>我们把每个关键字对应的值理解为一个对象，为了进入对象内部，用’.’来操作也就很理所当然了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/12/2018年使用ipv6-XX-net翻墙/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuboona Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Focus on my own.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/12/2018年使用ipv6-XX-net翻墙/" itemprop="url">2018年使用ipv6-XX-net翻墙</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-12T10:45:56+08:00">
                2020-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="2018年ubuntu使用XXnet"><a href="#2018年ubuntu使用XXnet" class="headerlink" title="2018年ubuntu使用XXnet"></a>2018年ubuntu使用XXnet</h1><hr>
<p><em>从大概两个月前开始，xx-net开始不好用了，几乎所有的ipv4的ip都被封锁了没有办法上网，所以很长一段时间我告别了它，openvpn成了我的最后的伙伴（很多其他的手机vpn软件也开始失效了)</em><br><em>但是今天我终于通过使用ipv6借助xx-net又能翻出围墙了</em></p>
<h2 id="1、准备工作"><a href="#1、准备工作" class="headerlink" title="1、准备工作"></a>1、准备工作</h2><ol>
<li>下载最新版的<a href="https://github.com/XX-net/XX-Net/blob/master/code/default/download.md" target="_blank" rel="noopener">xx-net</a></li>
<li>在ubuntu下安装miredo， miredo提供一种 IPv6/IPv4转换技术，它让只能访问ipv4的网络用户能够体验到ipv6的网络。当然如果你的网络运营商已经提供了ipv6服务那你就大可不必装这个软件了。（<a href="http://test-ipv6.com/" target="_blank" rel="noopener">查看是否支持ipv6</a>）</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 安装miredo</span><br><span class="line">sudo apt install miredo</span><br><span class="line"><span class="meta">#</span> 并且启动miredo，默认不是开机启动项，所以每次重新开机以后都要重新启动</span><br><span class="line">sudo service miredo start</span><br></pre></td></tr></table></figure>
<h2 id="2、进行安装"><a href="#2、进行安装" class="headerlink" title="2、进行安装"></a>2、进行安装</h2><ol>
<li>安装xx-net，这个大家应该都比较熟，首先解压安装包</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 解压</span><br><span class="line">sudo unzip XX-Net-3.8.7.zip</span><br><span class="line"><span class="meta">#</span> 移动xx-net到/opt/目录，这个目录是我比较喜欢的软件安装目录，一般deb包安装的软件也都是安装在这个目录下面</span><br><span class="line">sudo mv XX-Net-3.8.7 /opt/</span><br><span class="line"><span class="meta">#</span> 开始运行</span><br><span class="line">sudo /opt/XX-Net-3.8.7/start</span><br></pre></td></tr></table></figure>
<h2 id="3、进入localhost-8085管理界面"><a href="#3、进入localhost-8085管理界面" class="headerlink" title="3、进入localhost:8085管理界面"></a>3、进入localhost:8085管理界面</h2><p>经过以上的步骤，我们已经开启了xx-net 以及 miredo服务,在浏览器中访问xx-net 的管理界面，我们现在应该能够看到一些内容<br><img src="/2020/01/12/2018年使用ipv6-XX-net翻墙/xx_net.png" alt="图片1">:</p>
<h2 id="4、注意事项"><a href="#4、注意事项" class="headerlink" title="4、注意事项"></a>4、注意事项</h2><ol>
<li>教育网没有办法使用miredo</li>
<li>重启电脑后联网后，需要使用启动miredo</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo miredo</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Yuboona Zhang</p>
              <p class="site-description motion-element" itemprop="description">Don't focus too much.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/yuboona" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:yuboobaZhang@Yahoo.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuboona Zhang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

</body>
</html>
